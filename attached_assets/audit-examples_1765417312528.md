# Python-—Å–∫—Ä–µ–ø–µ—Ä –¥–ª—è –∞—É–¥–∏—Ç–∞ compliance: –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ –∫–æ–Ω—Ñ–∏–≥

## üîß –§–ê–ô–õ –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò (requirements.txt)

```
# Web Scraping
selenium==4.15.2
beautifulsoup4==4.12.2
requests==2.31.0
cloudscraper==1.2.71
aiohttp==3.9.1

# LLM & AI
langchain==0.1.4
langchain-gigachat==0.0.7
openai==1.3.1

# Database & Cache
sqlalchemy==2.0.23
psycopg2-binary==2.9.9
redis==5.0.1

# API & Web Framework
fastapi==0.104.1
uvicorn==0.24.0
pydantic==2.5.0
pydantic-settings==2.1.0

# Utilities
python-dotenv==1.0.0
aiofiles==23.2.1
python-multipart==0.0.6
geoip2==4.7.0
maxminddb==2.2.0

# Logging & Monitoring
python-json-logger==2.0.7
sentry-sdk==1.38.0

# Testing
pytest==7.4.3
pytest-asyncio==0.21.1
```

---

## üìù –§–ê–ô–õ –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò (.env)

```
# LLM API Keys
GIGACHAT_API_KEY=your_gigachat_token_here
GIGACHAT_MODEL=GigaChat
GIGACHAT_TEMPERATURE=0.5

# OpenAI (fallback)
OPENAI_API_KEY=sk-your-key-here
OPENAI_MODEL=gpt-4

# Database
DATABASE_URL=postgresql://user:password@localhost:5432/compliance_db
REDIS_URL=redis://localhost:6379

# GeoIP Database
GEOIP_DB_PATH=./data/GeoLite2-City.mmdb

# Selenium
CHROMEDRIVER_PATH=/usr/bin/chromedriver
SELENIUM_HEADLESS=True
SELENIUM_TIMEOUT=30

# API
API_PORT=8000
API_HOST=0.0.0.0
DEBUG=False

# Logging
LOG_LEVEL=INFO
SENTRY_DSN=https://your-sentry-key@sentry.io/project
```

---

## üöÄ –ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–µ–ø–µ—Ä (–≤—Å–µ–≥–æ 20 —Å—Ç—Ä–æ–∫)

```python
from audit_engine import ComplianceAudit
import json

# –ó–∞–ø—É—Å–∫ –∞—É–¥–∏—Ç–∞
audit = ComplianceAudit("https://example.com")
report = audit.run_audit(level2=True)

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
print(f"–°–∞–π—Ç: {report.url}")
print(f"–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: {report.final_score:.1f}%")
print(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –Ω–∞—Ä—É—à–µ–Ω–∏–π: {report.violations_by_severity['CRITICAL']}")

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ JSON
with open("report.json", "w", encoding="utf-8") as f:
    json.dump(report.__dict__, f, indent=2, ensure_ascii=False)
```

---

### –ü—Ä–∏–º–µ—Ä 2: –ú–∞—Å—Å–æ–≤—ã–π –∞—É–¥–∏—Ç —Å Celery

```python
# tasks.py
from celery import Celery
from audit_engine import ComplianceAudit
import time

app = Celery('compliance_audit', broker='redis://localhost:6379')

@app.task(bind=True)
def audit_website(self, url: str):
    """–§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è –∞—É–¥–∏—Ç–∞ —Å–∞–π—Ç–∞"""
    self.update_state(state='PROGRESS', meta={'current': 0, 'total': 100})
    
    try:
        audit = ComplianceAudit(url)
        report = audit.run_audit(level2=True)
        
        self.update_state(state='PROGRESS', meta={'current': 100, 'total': 100})
        
        return {
            'status': 'success',
            'url': report.url,
            'score': report.final_score,
            'violations': report.total_violations
        }
    except Exception as e:
        self.update_state(state='FAILURE', meta={'error': str(e)})
        raise

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
from tasks import audit_website

# –ó–∞–ø—É—Å–∫ –∞—É–¥–∏—Ç–∞ –≤ —Ñ–æ–Ω–µ
task = audit_website.delay("https://example.com")
print(f"Task ID: {task.id}")

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
status = audit_website.AsyncResult(task.id).state
print(f"Status: {status}")
```

---

### –ü—Ä–∏–º–µ—Ä 3: FastAPI Endpoint

```python
# main.py
from fastapi import FastAPI, BackgroundTasks, HTTPException
from pydantic import BaseModel
from audit_engine import ComplianceAudit
from tasks import audit_website
import uuid

app = FastAPI(title="Compliance Audit API")

class AuditRequest(BaseModel):
    url: str
    level2: bool = True
    email: str = None  # –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

class AuditResponse(BaseModel):
    task_id: str
    url: str
    status: str

# –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∞—É–¥–∏—Ç (–±—ã—Å—Ç—Ä—ã–π)
@app.post("/api/v1/audit/quick")
async def quick_audit(req: AuditRequest):
    """–ë—ã—Å—Ç—Ä—ã–π –∞—É–¥–∏—Ç (—Ç–æ–ª—å–∫–æ –£—Ä–æ–≤–µ–Ω—å 1)"""
    try:
        audit = ComplianceAudit(req.url)
        report = audit.run_audit(level2=False)
        return {
            "success": True,
            "url": report.url,
            "score": report.final_score,
            "violations": report.violations_by_severity
        }
    except Exception as e:
        raise HTTPException(status_code=400, detail=str(e))

# –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∞—É–¥–∏—Ç (–≥–ª—É–±–æ–∫–∏–π)
@app.post("/api/v1/audit/deep")
async def deep_audit(req: AuditRequest, background_tasks: BackgroundTasks):
    """–ì–ª—É–±–æ–∫–∏–π –∞—É–¥–∏—Ç (–£—Ä–æ–≤–µ–Ω—å 1 + 2)"""
    task_id = str(uuid.uuid4())
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ–æ–Ω–æ–≤—É—é –∑–∞–¥–∞—á—É
    background_tasks.add_task(audit_website.delay, req.url)
    
    return {
        "task_id": task_id,
        "status": "PENDING",
        "message": "Audit started, check status with task_id"
    }

# –°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏
@app.get("/api/v1/audit/status/{task_id}")
async def get_status(task_id: str):
    """–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∞—É–¥–∏—Ç–∞"""
    from tasks import audit_website
    from celery.result import AsyncResult
    
    result = AsyncResult(task_id, app=audit_website.app)
    
    return {
        "task_id": task_id,
        "state": result.state,
        "current": result.info.get('current', 0) if isinstance(result.info, dict) else 0,
        "total": result.info.get('total', 100) if isinstance(result.info, dict) else 100,
        "result": result.result if result.state == 'SUCCESS' else None
    }

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π endpoint –¥–ª—è –±–∞—Ç—á–∞
@app.post("/api/v1/audit/batch")
async def batch_audit(urls: list[str]):
    """–ê—É–¥–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–∞–π—Ç–æ–≤"""
    results = []
    
    for url in urls:
        audit = ComplianceAudit(url)
        report = audit.run_audit(level2=False)  # –î–ª—è –±–∞—Ç—á–∞ —Ç–æ–ª—å–∫–æ Level 1
        results.append({
            "url": report.url,
            "score": report.final_score,
            "violations": report.total_violations
        })
    
    return {"audits": results, "total": len(results)}

# –ó–∞–ø—É—Å–∫
if __name__ == "__main__":
    import uvicorn
    uvicorn.run(app, host="0.0.0.0", port=8000)
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API:**
```bash
# –ë—ã—Å—Ç—Ä—ã–π –∞—É–¥–∏—Ç
curl -X POST http://localhost:8000/api/v1/audit/quick \
  -H "Content-Type: application/json" \
  -d '{"url": "https://example.com", "level2": false}'

# –ì–ª—É–±–æ–∫–∏–π –∞—É–¥–∏—Ç
curl -X POST http://localhost:8000/api/v1/audit/deep \
  -H "Content-Type: application/json" \
  -d '{"url": "https://example.com"}'

# –°—Ç–∞—Ç—É—Å
curl http://localhost:8000/api/v1/audit/status/abc123
```

---

### –ü—Ä–∏–º–µ—Ä 4: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏

```python
# custom_checks.py
from audit_engine import AuditResult
from bs4 import BeautifulSoup
import re

class CustomAuditChecks:
    """–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π"""
    
    def __init__(self, html: str):
        self.soup = BeautifulSoup(html, 'html.parser')
        
    def check_custom_gdpr_gdpr_schrems_ii(self) -> AuditResult:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ Schrems II (—Ç—Ä–∞–Ω—Å–≥—Ä–∞–Ω–∏—á–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—á–∏ –≤ –°–®–ê)"""
        text = self.soup.get_text()
        
        # –ò—â–µ–º —É–ø–æ–º–∏–Ω–∞–Ω–∏—è US data centers, AWS, Google Cloud
        us_indicators = [
            r'AWS', r'Amazon Web Services',
            r'Google Cloud', r'Azure',
            r'usa', r'united states', r'united.{0,5}states',
            r'–°–®–ê', r'–°–æ–µ–¥–∏–Ω—ë–Ω–Ω—ã–µ –®—Ç–∞—Ç—ã'
        ]
        
        has_us_infra = any(
            re.search(p, text, re.IGNORECASE) 
            for p in us_indicators
        )
        
        if has_us_infra:
            # –ò—â–µ–º –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –¥–ª—è —Ç—Ä–∞–Ω—Å–≥—Ä–∞–Ω–∏—á–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏
            dpa_indicators = [
                r'standard contractual clauses',
                r'SCC', r'adequacy decision',
                r'–¥–æ–≥–æ–≤–æ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏', r'DPA', r'contract'
            ]
            
            has_dpa = any(
                re.search(p, text, re.IGNORECASE)
                for p in dpa_indicators
            )
            
            if has_dpa:
                status = "PASS"
                evidence = "–ù–∞–π–¥–µ–Ω—ã —É–ø–æ–º–∏–Ω–∞–Ω–∏—è SCC/DPA –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –¥–ª—è US –ø–µ—Ä–µ–¥–∞—á"
            else:
                status = "FAIL"
                evidence = "–ù–∞–π–¥–µ–Ω–∞ –∏–Ω—Ñ—Ä–∞ –≤ –°–®–ê, –Ω–æ –Ω–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏—è SCC/DPA –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤"
        else:
            status = "PASS"
            evidence = "–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–µ –≤ –°–®–ê, Schrems II –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ"
            
        return AuditResult(
            criterion_id="GDPR-011",
            criterion_name="Schrems II —Ç—Ä–∞–Ω—Å–≥—Ä–∞–Ω–∏—á–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—á–∏",
            status=status,
            evidence=evidence,
            severity="CRITICAL",
            requires_llm=False
        )
        
    def check_children_data_protection(self) -> AuditResult:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—â–∏—Ç—ã –¥–∞–Ω–Ω—ã—Ö –¥–µ—Ç–µ–π (–Ω–æ–≤–æ–µ 2025)"""
        text = self.soup.get_text().lower()
        
        # –ò—â–µ–º —Ü–µ–ª–µ–≤—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é
        child_indicators = [
            r'–¥–ª—è –¥–µ—Ç–µ–π', r'–ø–æ–¥—Ä–æ—Å—Ç–∫–∏', r'—à–∫–æ–ª[–∞]?',
            r'educational', r'kids', r'children',
            r'–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç', r'parental consent'
        ]
        
        is_for_children = any(
            re.search(p, text, re.IGNORECASE)
            for p in child_indicators
        )
        
        if not is_for_children:
            return AuditResult(
                criterion_id="NEW-002",
                criterion_name="–ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –¥–µ—Ç–µ–π",
                status="PASS",
                evidence="–°–∞–π—Ç –Ω–µ —Ü–µ–ª–∏—Ç—Å—è –Ω–∞ –¥–µ—Ç–µ–π",
                severity="HIGH"
            )
            
        # –ï—Å–ª–∏ —Ü–µ–ª–∏—Ç—Å—è –Ω–∞ –¥–µ—Ç–µ–π, –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
        protection_indicators = [
            r'parental consent', r'—Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ',
            r'—Å–æ–≥–ª–∞—Å–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—è', r'data minimization',
            r'–º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö', r'parental controls',
            r'—Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å'
        ]
        
        has_protection = any(
            re.search(p, text, re.IGNORECASE)
            for p in protection_indicators
        )
        
        status = "PASS" if has_protection else "FAIL"
        evidence = "–°–∞–π—Ç —Ü–µ–ª–∏—Ç—Å—è –Ω–∞ –¥–µ—Ç–µ–π –∏" + (
            " –∏–º–µ–µ—Ç –º–µ—Ä—ã –∑–∞—â–∏—Ç—ã" if has_protection else " –ù–ï –∏–º–µ–µ—Ç –º–µ—Ä –∑–∞—â–∏—Ç—ã"
        )
        
        return AuditResult(
            criterion_id="NEW-002",
            criterion_name="–ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –¥–µ—Ç–µ–π",
            status=status,
            evidence=evidence,
            severity="HIGH",
            requires_llm=True
        )
        
    def check_ai_transparency(self) -> AuditResult:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AI (–Ω–æ–≤–æ–µ 2025)"""
        text = self.soup.get_text()
        
        # –ò—â–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AI
        ai_indicators = [
            r'artificial intelligence', r'AI-generated',
            r'machine learning', r'–Ω–µ–π—Ä–æ—Å–µ—Ç—å',
            r'AI', r'chatbot', r'–∞–≤—Ç–æ–º–∞—Ç–∏–∑[–∞]?',
            r'–∞–ª–≥–æ—Ä–∏—Ç–º', r'automatic decision'
        ]
        
        uses_ai = any(
            re.search(p, text, re.IGNORECASE)
            for p in ai_indicators
        )
        
        if not uses_ai:
            return AuditResult(
                criterion_id="NEW-003",
                criterion_name="AI –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å",
                status="PASS",
                evidence="AI –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ",
                severity="MEDIUM"
            )
            
        # –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è AI, –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ
        disclosure_indicators = [
            r'disclosure', r'—Ä–∞—Å–∫—Ä—ã—Ç–∏–µ',
            r'automated decision', r'–∞–≤—Ç–æ–º–∞—Ç–∏–∑',
            r'—É–≤–µ–¥–æ–º–ª—è–µ–º', r'notice', r'–ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º',
            r'–ø—Ä–∞–≤–æ–≤—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è', r'significant effect'
        ]
        
        has_disclosure = any(
            re.search(p, text, re.IGNORECASE)
            for p in disclosure_indicators
        )
        
        status = "PASS" if has_disclosure else "FAIL"
        evidence = "AI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è" + (
            " –∏ —Ä–∞—Å–∫—Ä—ã—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é" if has_disclosure else " –Ω–æ –ù–ï —Ä–∞—Å–∫—Ä—ã—Ç–æ"
        )
        
        return AuditResult(
            criterion_id="NEW-003",
            criterion_name="AI –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å",
            status=status,
            evidence=evidence,
            severity="MEDIUM",
            requires_llm=True
        )
        
    def run_custom_checks(self):
        """–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫"""
        return [
            self.check_custom_gdpr_gdpr_schrems_ii(),
            self.check_children_data_protection(),
            self.check_ai_transparency()
        ]

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
from audit_engine import AuditEngineLevel1, ComplianceAudit

audit = ComplianceAudit("https://example.com")
level1 = AuditEngineLevel1(audit.url)
level1.scrape_website()

custom = CustomAuditChecks(level1.html)
custom_results = custom.run_custom_checks()

print(f"Custom checks: {[r.status for r in custom_results]}")
```

---

### –ü—Ä–∏–º–µ—Ä 5: –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF/Excel

```python
# export.py
from audit_engine import AuditReport
from fpdf import FPDF
import openpyxl
from datetime import datetime

class ReportExporter:
    """–≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–æ–≤ –≤ —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã"""
    
    @staticmethod
    def export_to_pdf(report: AuditReport, filename: str = "report.pdf"):
        """–≠–∫—Å–ø–æ—Ä—Ç –≤ PDF"""
        pdf = FPDF()
        pdf.add_page()
        pdf.set_font("Arial", "B", 16)
        
        pdf.cell(0, 10, f"Audit Report: {report.url}", ln=True)
        pdf.set_font("Arial", "", 10)
        pdf.cell(0, 10, f"Date: {report.timestamp}", ln=True)
        pdf.cell(0, 10, f"Score: {report.final_score:.1f}%", ln=True)
        pdf.ln(10)
        
        pdf.set_font("Arial", "B", 12)
        pdf.cell(0, 10, "Results:", ln=True)
        pdf.set_font("Arial", "", 10)
        
        for result in report.level_1_results:
            status_icon = "‚úì" if result.status == "PASS" else "‚úó"
            pdf.cell(0, 10, f"{status_icon} {result.criterion_id}: {result.criterion_name}", ln=True)
            pdf.multi_cell(0, 5, f"  {result.evidence}")
            
        pdf.output(filename)
        return filename
        
    @staticmethod
    def export_to_excel(report: AuditReport, filename: str = "report.xlsx"):
        """–≠–∫—Å–ø–æ—Ä—Ç –≤ Excel"""
        wb = openpyxl.Workbook()
        ws = wb.active
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        ws['A1'] = f"Audit Report: {report.url}"
        ws['A2'] = f"Date: {report.timestamp}"
        ws['A3'] = f"Final Score: {report.final_score:.1f}%"
        
        # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
        row = 5
        ws['A' + str(row)] = "ID"
        ws['B' + str(row)] = "Name"
        ws['C' + str(row)] = "Status"
        ws['D' + str(row)] = "Evidence"
        ws['E' + str(row)] = "Severity"
        
        row += 1
        for result in report.level_1_results:
            ws['A' + str(row)] = result.criterion_id
            ws['B' + str(row)] = result.criterion_name
            ws['C' + str(row)] = result.status
            ws['D' + str(row)] = result.evidence
            ws['E' + str(row)] = result.severity
            row += 1
            
        # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
        row += 2
        ws['A' + str(row)] = "Recommendations"
        row += 1
        for rec in report.recommendations:
            ws['A' + str(row)] = f"‚Ä¢ {rec}"
            row += 1
            
        wb.save(filename)
        return filename

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
from audit_engine import ComplianceAudit

audit = ComplianceAudit("https://example.com")
report = audit.run_audit()

exporter = ReportExporter()
exporter.export_to_pdf(report, "audit_report.pdf")
exporter.export_to_excel(report, "audit_report.xlsx")
```

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

```python
# tests/test_audit.py
import pytest
from audit_engine import ComplianceAudit, AuditEngineLevel1
from unittest.mock import patch, MagicMock

@pytest.fixture
def sample_html():
    return """
    <html>
    <head><title>Test Site</title></head>
    <body>
        <h1>Welcome</h1>
        <a href="/privacy-policy">Privacy Policy</a>
        <input type="checkbox"> <label>I agree to processing</label>
        <script>
            // Google Analytics
            window.dataLayer = window.dataLayer || [];
            gtag('config', 'GA_ID');
        </script>
    </body>
    </html>
    """

@pytest.mark.asyncio
async def test_privacy_policy_detection(sample_html):
    """–¢–µ—Å—Ç: –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏"""
    with patch.object(AuditEngineLevel1, 'scrape_website', return_value=True):
        with patch.object(AuditEngineLevel1, 'html', sample_html):
            audit = AuditEngineLevel1("https://example.com")
            audit.html = sample_html
            audit.soup = __import__('bs4').BeautifulSoup(sample_html, 'html.parser')
            
            result = audit.check_privacy_policy()
            assert result.status == "PASS"

def test_https_check():
    """–¢–µ—Å—Ç: –ø—Ä–æ–≤–µ—Ä–∫–∞ HTTPS"""
    audit = ComplianceAudit("https://example.com")
    assert audit.url.startswith("https://")
    
def test_url_normalization():
    """–¢–µ—Å—Ç: –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è URL"""
    audit1 = ComplianceAudit("example.com")
    audit2 = ComplianceAudit("https://example.com")
    
    assert audit1.url == audit2.url

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
# pytest tests/ -v
```

---

## üìä –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨ –ò –ú–ê–°–®–¢–ê–ë–ò–†–û–í–ê–ù–ò–ï

```python
# monitor.py
import asyncio
import time
from audit_engine import ComplianceAudit
import logging

logger = logging.getLogger(__name__)

class PerformanceMonitor:
    """–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∞—É–¥–∏—Ç–æ–≤"""
    
    @staticmethod
    async def benchmark_single_audit(url: str) -> dict:
        """–ë–µ–Ω—á–º–∞—Ä–∫ –æ–¥–Ω–æ–≥–æ –∞—É–¥–∏—Ç–∞"""
        start = time.time()
        
        audit = ComplianceAudit(url)
        report = audit.run_audit(level2=True)
        
        elapsed = time.time() - start
        
        return {
            "url": url,
            "time_seconds": elapsed,
            "score": report.final_score,
            "violations": report.total_violations
        }
        
    @staticmethod
    async def benchmark_batch(urls: list[str]):
        """–ë–µ–Ω—á–º–∞—Ä–∫ –±–∞—Ç—á–∞"""
        start = time.time()
        
        tasks = [
            PerformanceMonitor.benchmark_single_audit(url)
            for url in urls
        ]
        
        results = await asyncio.gather(*tasks)
        
        elapsed = time.time() - start
        avg_time = elapsed / len(urls)
        
        logger.info(f"Batch audit: {len(urls)} sites, {elapsed:.1f}s total, {avg_time:.1f}s avg")
        
        return {
            "total_sites": len(urls),
            "total_time": elapsed,
            "avg_time_per_site": avg_time,
            "results": results
        }

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
import asyncio

urls = ["https://example1.com", "https://example2.com", "https://example3.com"]
results = asyncio.run(PerformanceMonitor.benchmark_batch(urls))
```

---

**–í—Å–µ –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏ –¥–µ–ø–ª–æ—é! üöÄ**
